{% extends "layout.html" %}
{% block title %}Shop{% endblock %}
{% block content %}
<div class="mx-auto container-fluid">
    <div class="h1">Shop</div>
    <div class="row row-cols-1 row-cols-xl-5 row-cols-lg-4 row-cols-md-3 row-cols-sm-2 row-cols-xs-1">
        {% if items|length == 0 %}
        <div class="col">
            Not items
        </div>
        {% else %}
        {% for item in items %}
        <div class="col">
            <div class="card">
                <div class="card-header">
                    {{item.name}}
                </div>
                {% if item.image %}
                <img class="mt-3 mx-auto" style="aspect-ratio:1 !important" height="100px" width="100px" src="{{item.image}}"/>
                {% endif %}
                <div class="card-body">
                    <div class="card-text">{{item.description}}</div>
                    <div class="card-text">Cost: {{item.cost}}</div>
                </div>
                <div class="card-footer">
                    <button class="btn btn-primary" onclick="add_to_cart({{item.id}})">Add to Cart</button>
                </div>
            </div>
        </div>
        {% endfor %}
        {% endif %}

    </div>
</div>
<script>
    function add_to_cart(item_id){
        console.log("adding item to cart", item_id);
        fetch("/shop/add-to-cart",{
            method:"POST",
            headers: {
                "Content-Type":"application/x-www-form-urlencoded"
            },
            body: `item_id=${item_id}`
        }).then(response=>response.json())
        .then(data=>{
            console.log("added to cart", data);
            alert(data.message);
        })
        .catch(e=>{
            console.log("Request error", e);
            alert("Error adding item to cart");
        });
    }
</script>
{% endblock %}
